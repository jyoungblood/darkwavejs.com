---
import { getCollection } from 'astro:content';

const fieldguideEntries = await getCollection('fieldguide');

// Sort entries: index first, then alphabetically
const sortedEntries = fieldguideEntries.sort((a, b) => {
  if (a.slug === 'index') return -1;
  if (b.slug === 'index') return 1;
  return a.data.title.localeCompare(b.data.title);
});

const currentPath = Astro.url.pathname;
---

<nav>
  <h2 class="text-sm font-semibold text-zinc-400 uppercase tracking-wide mb-4">Field Guide</h2>
  <ul class="space-y-1">
    {sortedEntries.map((entry) => {
      const href = entry.slug === 'index' ? '/fieldguide/' : `/fieldguide/${entry.slug}/`;
      const isActive = currentPath === href || currentPath === href.slice(0, -1);
      return (
        <li>
          <a
            href={href}
            class:list={[
              "block px-3 py-2 rounded text-sm transition-colors",
              isActive
                ? "bg-zinc-800 text-white"
                : "text-zinc-400 hover:text-white hover:bg-zinc-800/50"
            ]}
          >
            {entry.data.title}
          </a>
        </li>
      );
    })}
  </ul>
  <div class="mt-8 pt-4 border-t border-zinc-800">
    <a href="/docs/" class="text-sm text-zinc-500 hover:text-zinc-300 transition-colors">
      Back to Docs
    </a>
  </div>
</nav>
