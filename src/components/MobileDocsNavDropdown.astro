---
interface Props {
  currentTitle: string;
}

const { currentTitle } = Astro.props;
---

<div class="sm:hidden mb-6 relative">
  <button
    id="mobile-docs-nav-toggle"
    class="w-full flex items-center justify-between px-4 py-3 text-sm font-medium text-neutral-100 bg-neutral-900 border border-neutral-800 rounded-md hover:border-neutral-700 transition-colors"
    type="button"
    aria-expanded="false"
  >
    <span>{currentTitle}</span>
    <svg
      id="mobile-docs-chevron"
      class="w-4 h-4 transition-transform"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
    >
      <path d="M6 9l6 6 6-6" />
    </svg>
  </button>

  <nav
    id="mobile-docs-nav-dropdown"
    class="hidden absolute top-full left-0 right-0 mt-2 p-4 bg-neutral-900 border border-neutral-800 rounded-md space-y-4 max-h-[70vh] overflow-y-auto z-50"
  >
    <slot />
  </nav>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Mobile dropdown toggle
    const mobileDocsNavToggle = document.getElementById('mobile-docs-nav-toggle');
    const mobileDocsNavDropdown = document.getElementById('mobile-docs-nav-dropdown');
    const mobileDocsChevron = document.getElementById('mobile-docs-chevron');

    if (mobileDocsNavToggle && mobileDocsNavDropdown && mobileDocsChevron) {
      mobileDocsNavToggle.addEventListener('click', () => {
        const isHidden = mobileDocsNavDropdown.classList.contains('hidden');

        if (isHidden) {
          mobileDocsNavDropdown.classList.remove('hidden');
          mobileDocsChevron.style.transform = 'rotate(180deg)';
          mobileDocsNavToggle.setAttribute('aria-expanded', 'true');
        } else {
          mobileDocsNavDropdown.classList.add('hidden');
          mobileDocsChevron.style.transform = '';
          mobileDocsNavToggle.setAttribute('aria-expanded', 'false');
        }
      });
    }

    // Collapsible sections - Mobile
    document.querySelectorAll('.nav-section-toggle-mobile').forEach(button => {
      button.addEventListener('click', () => {
        const section = button.closest('.nav-section-mobile');
        const content = section?.querySelector('.nav-section-content-mobile');
        const chevron = button.querySelector('.section-chevron-mobile');
        const isExpanded = button.getAttribute('aria-expanded') === 'true';

        if (content) {
          content.style.display = isExpanded ? 'none' : '';
        }
        if (chevron) {
          chevron.style.transform = isExpanded ? '' : 'rotate(180deg)';
        }
        button.setAttribute('aria-expanded', isExpanded ? 'false' : 'true');
      });
    });
  });
</script>
